(this["webpackJsonpmesto-react-auth"]=this["webpackJsonpmesto-react-auth"]||[]).push([[0],{29:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(19),r=n.n(c),o=(n(29),n(9)),i=n(23),l=n(2),u=n(20),d=n(21),p={inputClass:"popup__input",inputErrorClass:"popup__input_type_error",errorClass:"popup__error",errorClassVisible:"popup__error_visible"},b={inputClass:"auth-form__input",inputErrorClass:"auth-form__input_type_error",errorClass:"auth-form__error",errorClassVisible:"auth-form__error_visible"},j=new(function(){function e(t){Object(u.a)(this,e),this._baseUrl=t.baseUrl,this._token=localStorage.getItem("jwt")?"Bearer ".concat(localStorage.getItem("jwt")):null,this._contentType=t.headers["Content-Type"]}return Object(d.a)(e,[{key:"_resultHandler",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"authorize",value:function(e){var t=this,n=e.email,a=e.password;return fetch(this._baseUrl+"/signin",{method:"POST",headers:{"Content-Type":this._contentType},body:JSON.stringify({password:a,email:n})}).then((function(e){return t._resultHandler(e)}))}},{key:"register",value:function(e){var t=this,n=e.email,a=e.password;return fetch(this._baseUrl+"/signup",{method:"POST",headers:{"Content-Type":this._contentType},body:JSON.stringify({password:a,email:n})}).then((function(e){return t._resultHandler(e)}))}},{key:"checkToken",value:function(){var e=this;return this._token?fetch(this._baseUrl+"/users/me",{method:"GET",headers:{"Content-Type":this._contentType,authorization:this._token}}).then((function(t){return e._resultHandler(t)})):Promise.reject("no token")}},{key:"getInitialCards",value:function(){var e=this;return fetch(this._baseUrl+"/cards",{headers:{authorization:this._token}}).then((function(t){return e._resultHandler(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._baseUrl+"/users/me",{headers:{authorization:this._token}}).then((function(t){return e._resultHandler(t)}))}},{key:"setUserInfo",value:function(e,t){var n=this;return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:{"Content-Type":this._contentType,authorization:this._token},body:JSON.stringify({name:e,about:t})}).then((function(e){return n._resultHandler(e)}))}},{key:"setUserAvatar",value:function(e){var t=this;return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:{"Content-Type":this._contentType,authorization:this._token},body:JSON.stringify({avatar:e})}).then((function(e){return t._resultHandler(e)}))}},{key:"addNewCard",value:function(e,t){var n=this;return fetch(this._baseUrl+"/cards",{method:"POST",headers:{"Content-Type":this._contentType,authorization:this._token},body:JSON.stringify({name:e,link:t})}).then((function(e){return n._resultHandler(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.likeCard(e):this.dislikeCard(e)}},{key:"likeCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/".concat(e,"/likes"),{method:"PUT",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}},{key:"dislikeCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/".concat(e,"/likes"),{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}},{key:"setNewToken",value:function(e){this._token="Bearer ".concat(e)}}]),e}())({baseUrl:"https://api.mesto-reinat.nomoredomains.monster",headers:{"Content-Type":"application/json"}}),h=Object(a.createContext)({}),m=n(3),f=n.p+"static/media/logo.bbe2a6ea.svg",O=n(0);var _=Object(m.i)((function(e){var t=e.currentLocation,n=e.login,s=e.signOut,c=Object(a.useState)(!1),r=Object(l.a)(c,2),i=r[0],u=r[1],d=Object(a.useState)("header"),p=Object(l.a)(d,2),b=p[0],j=p[1],h=i?{burgerClass:"header__humburger-button header__humburger-button_type_cross",rightBlockClass:"header__right-block header__right-block_visible"}:{burgerClass:"header__humburger-button",rightBlockClass:"header__right-block"},m=function(e,t,n,a,s,c){switch(e){case"/sign-in":return Object(O.jsx)(o.b,{className:"header__link",to:"/sign-up",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"});case"/":return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("button",{className:n,onClick:s}),Object(O.jsxs)("div",{className:a,children:[Object(O.jsx)("p",{className:"header__email",children:t}),Object(O.jsx)(o.b,{className:"header__link header__link_faded",to:"/sign-in",onClick:c,children:"\u0412\u044b\u0439\u0442\u0438"})]})]});default:return Object(O.jsx)(o.b,{className:"header__link",to:"/sign-in",children:"\u0412\u043e\u0439\u0442\u0438"})}}(t,n,h.burgerClass,h.rightBlockClass,(function(){u(!i),j("header"===b?"header header_lowered":"header")}),s),_="/"===t?"header__content":"header__content header__content_simple";return Object(O.jsxs)("header",{className:"header",children:[Object(O.jsx)("div",{className:_,children:Object(O.jsx)("img",{src:f,className:"logo",alt:"Mesto Russia"})}),m]})}));var v=function(e){var t=e.card,n=e.onCardClick,s=e.onDeleteClick,c=e.onCardLike,r=Object(a.useState)(!1),o=Object(l.a)(r,2),i=o[0],u=o[1],d=Object(a.useContext)(h)._id,p=t.likes,b=t.owner,j=t.name,m=t.link,f=d===b,_=p.some((function(e){return e===d})),v=f?"element__delete-button":"element__delete-button element__delete-button_hidden",g=i?"element__like-button_loading":"",C="element__like-button ".concat(_?"element__like-button element__like-button_active":""," ").concat(g);return Object(a.useEffect)((function(){u(!1)}),[p]),Object(O.jsxs)("figure",{className:"element",children:[Object(O.jsx)("button",{className:"element__picture-button",style:{backgroundImage:"url(".concat(m,")")},onClick:function(){n(t)}}),Object(O.jsx)("button",{type:"button",className:v,onClick:function(){s(t)}}),Object(O.jsxs)("figcaption",{className:"element__caption",children:[Object(O.jsx)("h2",{className:"element__text",children:j}),Object(O.jsxs)("div",{className:"element__like-container",children:[Object(O.jsx)("button",{type:"button",className:C,onClick:function(){c(t),u(!0)}}),Object(O.jsx)("p",{className:"element__like-counter",children:p.length})]})]})]})};var g=function(e){var t=e.onEditProfile,n=e.onAddPlace,s=e.onEditAvatar,c=e.onCardClick,r=e.cards,o=e.onCardLike,i=e.onCardDelete,l=Object(a.useContext)(h),u=l.name,d=l.about,p=l.avatar;return Object(O.jsxs)("main",{className:"content",children:[Object(O.jsxs)("section",{className:"profile",children:[Object(O.jsx)("button",{className:"profile__avatar-button",onClick:s,style:{backgroundImage:"url(".concat(p,")")}}),Object(O.jsxs)("div",{className:"profile__info",children:[Object(O.jsx)("h1",{className:"profile__name",children:u}),Object(O.jsx)("button",{type:"button",className:"profile__edit-button",onClick:t}),Object(O.jsx)("p",{className:"profile__description",children:d})]}),Object(O.jsx)("button",{type:"button",className:"profile__add-button",onClick:n})]}),Object(O.jsx)("section",{className:"elements",children:r.map((function(e){return Object(O.jsx)(v,{card:e,onCardClick:c,onDeleteClick:i,onCardLike:o},e._id)})).reverse()})]})};var C=function(){var e=(new Date).getFullYear();return Object(O.jsx)("footer",{className:"footer",children:Object(O.jsxs)("p",{className:"copyright",children:["\xa9 ",e," Mesto Russia"]})})};var x=function(e){var t=e.name,n=e.title,a=e.children,s=e.isOpen,c=e.onClose,r=e.onSubmit,o=e.formValidity,i=e.buttonText,l=s?"popup popup_type_".concat(t," popup_opened"):"popup popup_type_".concat(t);return Object(O.jsx)("section",{className:l,children:Object(O.jsxs)("div",{className:"popup__container",children:[Object(O.jsx)("button",{type:"button",className:"popup__close-button",onClick:c}),Object(O.jsx)("h2",{className:"popup__title",children:n}),Object(O.jsxs)("form",{className:"popup__form",name:t,onSubmit:r,children:[a,Object(O.jsx)("button",{type:"submit",className:"popup__button",disabled:!o,children:i})]})]})})},k=n(11),y=n(8);function N(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(a.useState)({}),n=Object(l.a)(t,2),s=n[0],c=n[1],r=Object(a.useState)({}),o=Object(l.a)(r,2),i=o[0],u=o[1],d=Object(a.useState)(!0),j=Object(l.a)(d,2),h=j[0],m=j[1],f=Object(a.useState)({}),O=Object(l.a)(f,2),_=O[0],v=O[1],g=Object(a.useState)({}),C=Object(l.a)(g,2),x=C[0],N=C[1],S=function(t){var n=t.target,a=e?b:p,r=a.inputClass,o=a.inputErrorClass,l=a.errorClass,d=a.errorClassVisible,j=n.name,h=n.value,f=n.validity.valid?r:"".concat(r," ").concat(o),O=n.validity.valid?l:"".concat(l," ").concat(d);c(Object(y.a)(Object(y.a)({},s),{},Object(k.a)({},j,h))),u(Object(y.a)(Object(y.a)({},i),{},Object(k.a)({},j,n.validationMessage))),v(Object(y.a)(Object(y.a)({},_),{},Object(k.a)({},j,f))),N(Object(y.a)(Object(y.a)({},x),{},Object(k.a)({},j,O))),m(n.closest("form").checkValidity())},w=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];c(e),u(t),m(s),v(n),N(a)}),[c,u,m]);return{values:s,handleChange:S,errors:i,inputsClasses:_,errorsClasses:x,isValid:h,resetForm:w,setValues:c,setIsValid:m}}var S=function(e){var t=e.isOpen,n=e.onClose,s=e.onUpdateUser,c=e.isLoading,r=p.inputClass,o=p.errorClass,i=N(),u=i.values,d=i.handleChange,b=i.errors,j=i.inputsClasses,m=i.errorsClasses,f=i.isValid,_=i.resetForm,v=Object(a.useContext)(h),g=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),C=Object(l.a)(g,2),k=C[0],y=C[1],S=Object(a.useRef)();return Object(a.useEffect)((function(){if(c){var e=[".","..","..."],t=0;S.current=setInterval((function(){y("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(S.current),y("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[c]),Object(a.useEffect)((function(){_({name:v.name,description:v.about},{name:"",description:""},{name:r,description:r},{name:o,description:o},!0)}),[t]),Object(O.jsxs)(x,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault();var t=u.name,n=u.description;s({name:t,about:n})},buttonText:k,formValidity:f,children:[Object(O.jsx)("input",{id:"profile-name-input",name:"name",required:!0,minLength:"2",maxLength:"40",className:j.name,placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",value:u.name||"",onChange:d}),Object(O.jsx)("span",{className:m.name,children:b.name}),Object(O.jsx)("input",{id:"profile-description-input",name:"description",required:!0,minLength:"2",maxLength:"200",className:j.description,placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",value:u.description||"",onChange:d}),Object(O.jsx)("span",{className:m.description,children:b.description})]})};var w=function(e){var t=e.isOpen,n=e.onClose,a=e.selectedCard,s=a?a.link:"#",c=a?a.name:"",r=t?"popup popup_opened popup_type_full-view":"popup popup_type_full-view";return Object(O.jsx)("section",{className:r,children:Object(O.jsx)("figure",{className:"popup__picture-container",children:Object(O.jsxs)("div",{className:"popup__picture-elements",children:[Object(O.jsx)("button",{type:"button",className:"popup__close-button",onClick:n}),Object(O.jsx)("img",{className:"popup__full-picture",alt:"\u041f\u043e\u043b\u043d\u043e\u044d\u043a\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440",src:s}),Object(O.jsx)("h2",{className:"popup__picture-title",children:c})]})})})};var T=function(e){var t=e.isOpen,n=e.onClose,s=e.onUpdateAvatar,c=e.isLoading,r=p.inputClass,o=p.errorClass,i=N(),u=i.values,d=i.handleChange,b=i.errors,j=i.inputsClasses,h=i.errorsClasses,m=i.isValid,f=i.resetForm,_=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),v=Object(l.a)(_,2),g=v[0],C=v[1],k=Object(a.useRef)();return Object(a.useEffect)((function(){if(c){var e=[".","..","..."],t=0;k.current=setInterval((function(){C("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(k.current),C("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[c]),Object(a.useEffect)((function(){f({data:""},{data:""},{data:r},{data:o},!1)}),[t]),Object(O.jsxs)(x,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),s(u.data)},buttonText:g,formValidity:m,children:[Object(O.jsx)("input",{id:"avatar-link-input",name:"data",required:!0,type:"url",className:j.data,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",value:u.data||"",onChange:d}),Object(O.jsx)("span",{className:h.data,children:b.data})]})};var L=function(e){var t=e.isOpen,n=e.onClose,s=e.onAddPlace,c=e.isLoading,r=p.inputClass,o=p.errorClass,i=N(),u=i.values,d=i.handleChange,b=i.errors,j=i.inputsClasses,h=i.errorsClasses,m=i.isValid,f=i.resetForm,_=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),v=Object(l.a)(_,2),g=v[0],C=v[1],k=Object(a.useRef)();return Object(a.useEffect)((function(){if(c){var e=[".","..","..."],t=0;k.current=setInterval((function(){C("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(k.current),C("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[c]),Object(a.useEffect)((function(){f({name:"",data:""},{name:"",data:""},{name:r,data:r},{name:o,data:o})}),[t]),Object(O.jsxs)(x,{name:"card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault();var t=u.name,n=u.data;s({name:t,link:n})},buttonText:g,formValidity:m,children:[Object(O.jsx)("input",{id:"place-name-input",name:"name",required:!0,minLength:"2",maxLength:"30",className:j.name,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",onChange:d,value:u.name||""}),Object(O.jsx)("span",{className:h.name,children:b.name}),Object(O.jsx)("input",{id:"place-link-input",name:"data",required:!0,type:"url",className:j.data,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",onChange:d,value:u.data||""}),Object(O.jsx)("span",{className:h.data,children:b.data})]})};var E=function(e){var t=e.isOpen,n=e.onClose,s=e.selectedCard,c=e.onDeleteCard,r=e.isLoading,o=Object(a.useState)("\u0414\u0430"),i=Object(l.a)(o,2),u=i[0],d=i[1],p=Object(a.useRef)();return Object(a.useEffect)((function(){if(r){var e=[".","..","..."],t=0;p.current=setInterval((function(){d("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(p.current),d("\u0414\u0430")}),[r]),Object(O.jsx)(x,{name:"remove-card",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c(s)},buttonText:u,formValidity:!0})},I=n.p+"static/media/check.a9eb6caf.svg",U=n.p+"static/media/cross.d4ce2a26.svg";var P=function(e){var t=e.isOpen,n=e.onClose,a=t?"popup popup_type_tooltip popup_opened":"popup popup_type_tooltip",s=e.accepted?{text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",picSrc:I}:{text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",picSrc:U},c=s.text,r=s.picSrc;return Object(O.jsx)("section",{className:a,children:Object(O.jsxs)("div",{className:"popup__container",children:[Object(O.jsx)("button",{type:"button",className:"popup__close-button popup__close-button_type_info",onClick:n}),Object(O.jsx)("img",{className:"popup__info-img",alt:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",src:r}),Object(O.jsx)("p",{className:"popup__info-text",children:c})]})})};var V=function(e){var t=e.loggedIn,n=e.onSubmit,s=e.buttonText,c=b.inputClass,r=b.errorClass,o=N(!0),i=o.values,l=o.handleChange,u=o.errors,d=o.inputsClasses,p=o.errorsClasses,j=o.isValid,h=o.resetForm;return Object(a.useEffect)((function(){h({email:"",password:""},{email:"",password:""},{email:c,password:c},{email:r,password:r})}),[t]),Object(O.jsxs)("form",{className:"auth-form__container",onSubmit:function(e){e.preventDefault(),n(i)},children:[Object(O.jsxs)("fieldset",{className:"auth-form__inputs",children:[Object(O.jsx)("input",{className:d.email,id:"email-input",type:"email",required:!0,name:"email",minLength:"2",maxLength:"30",placeholder:"Email",value:i.email||"",onChange:l}),Object(O.jsx)("span",{className:p.email,children:u.email}),Object(O.jsx)("input",{className:d.password,id:"password-input",type:"password",required:!0,name:"password",minLength:"7",maxLength:"30",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:i.password||"",onChange:l}),Object(O.jsx)("span",{className:p.password,children:u.password})]}),Object(O.jsx)("button",{className:"auth-form__button",type:"submit",disabled:!j,children:s})]})};var D=function(e){var t=e.loggedIn,n=e.onLogin;return Object(O.jsxs)("div",{className:"auth-form",children:[Object(O.jsx)("h2",{className:"auth-form__header",children:"\u0412\u0445\u043e\u0434"}),Object(O.jsx)(V,{loggedIn:t,onSubmit:n,buttonText:"\u0412\u043e\u0439\u0442\u0438"})]})};var H=Object(m.i)((function(e){var t=e.loggedIn,n=e.onRegister;return Object(O.jsxs)("div",{className:"auth-form",children:[Object(O.jsx)("h2",{className:"auth-form__header",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(O.jsx)(V,{buttonText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",loggedIn:t,onSubmit:n}),Object(O.jsxs)("p",{className:"auth-form__bottom-message",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(O.jsx)(o.b,{className:"auth__link",to:"/sign-in",children:" \u0412\u043e\u0439\u0442\u0438 "})]})]})})),A=n(24),z=["component"],F=function(e){var t=e.component,n=Object(A.a)(e,z);return Object(O.jsx)(m.b,{children:function(){return n.loggedIn?Object(O.jsx)(t,Object(y.a)({},n)):Object(O.jsx)(m.a,{to:"./sign-in"})}})};var R=Object(m.i)((function(){var e=Object(m.g)(),t=Object(a.useState)(!1),n=Object(l.a)(t,2),s=n[0],c=n[1],r=Object(a.useState)(!1),o=Object(l.a)(r,2),u=o[0],d=o[1],p=Object(a.useState)(!1),b=Object(l.a)(p,2),f=b[0],v=b[1],x=Object(a.useState)(!1),k=Object(l.a)(x,2),y=k[0],N=k[1],I=Object(a.useState)(!1),U=Object(l.a)(I,2),V=U[0],A=U[1],z=Object(a.useState)(!1),R=Object(l.a)(z,2),q=R[0],B=R[1],J=Object(a.useState)({}),M=Object(l.a)(J,2),G=M[0],Y=M[1],K=Object(a.useState)({}),Q=Object(l.a)(K,2),W=Q[0],X=Q[1],Z=Object(a.useState)([]),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ne=Object(a.useState)({}),ae=Object(l.a)(ne,2),se=ae[0],ce=ae[1],re=Object(a.useState)(!1),oe=Object(l.a)(re,2),ie=oe[0],le=oe[1],ue=Object(a.useState)(!1),de=Object(l.a)(ue,2),pe=de[0],be=de[1],je=Object(a.useState)(!1),he=Object(l.a)(je,2),me=he[0],fe=he[1],Oe=Object(a.useState)(""),_e=Object(l.a)(Oe,2),ve=_e[0],ge=_e[1];function Ce(e){B(!0),fe(e),ke()}function xe(){document.removeEventListener("keydown",ye),document.removeEventListener("pointerdown",Ne),v(!1),c(!1),d(!1),N(!1),A(!1),B(!1),Y({}),ce({})}function ke(){document.addEventListener("keydown",ye),document.addEventListener("pointerdown",Ne)}Object(a.useEffect)((function(){j.checkToken().then((function(t){ge(t.email),be(!0),e.push("/")})).catch((function(e){"no token"!==e&&(Ce(!1),console.log(e))}))}),[]),Object(a.useEffect)((function(){pe&&Promise.all([j.getUserInfo(),j.getInitialCards()]).then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];X(n),te(a.cards)})).catch((function(e){console.log(e),Ce(!1)}))}),[pe]);var ye=Object(a.useCallback)((function(e){"Escape"===e.key&&xe()}),[]),Ne=Object(a.useCallback)((function(e){e.target.classList.contains("popup")&&xe()}),[]);return Object(O.jsx)(h.Provider,{value:W,children:Object(O.jsxs)("div",{className:"page",children:[Object(O.jsx)(_,{currentLocation:Object(m.h)().pathname,login:ve,signOut:function(){localStorage.removeItem("jwt"),be(!1)}}),Object(O.jsxs)(m.d,{children:[Object(O.jsx)(m.b,{exact:!0,path:"/sign-in",children:Object(O.jsx)(D,{loggedIn:pe,onLogin:function(t){var n=t.email,a=t.password;j.authorize({email:n,password:a}).then((function(t){var n;n=t.token,localStorage.setItem("jwt",n),j.setNewToken(n),be(!0),ge(t.email),e.push("/"),X(t)})).catch((function(e){Ce(!1),console.log(e)}))}})}),Object(O.jsx)(m.b,{exact:!0,path:"/sign-up",children:Object(O.jsx)(H,{loggedIn:pe,onRegister:function(t){var n=t.email,a=t.password;j.register({email:n,password:a}).then((function(t){Ce(!0),e.push("/sign-in")})).catch((function(e){Ce(!1),console.log(e)}))}})}),Object(O.jsx)(F,{exact:!0,path:"/",loggedIn:pe,component:g,onEditProfile:function(){ke(),c(!0)},onAddPlace:function(){ke(),d(!0)},onEditAvatar:function(){ke(),v(!0)},onCardClick:function(e){ke(),A(!0),Y(e)},cards:ee,onCardLike:function(e){var t=e.likes.some((function(e){return e===W._id}));j.changeLikeCardStatus(e._id,!t).then((function(t){te((function(n){return n.map((function(n){return n._id===e._id?t:n}))})),xe()})).catch((function(e){Ce(!1),console.log(e)}))},onCardDelete:function(e){ke(),N(!0),ce(e)}})]}),Object(O.jsx)(C,{}),Object(O.jsx)(P,{onClose:xe,isOpen:q,accepted:me}),Object(O.jsx)(S,{onUpdateUser:function(e){var t=e.name,n=e.about;le(!0),j.setUserInfo(t,n).then((function(e){X(e),xe()})).catch((function(e){Ce(!1),console.log(e)})).finally((function(){le(!1)}))},onClose:xe,isOpen:s,isLoading:ie}),Object(O.jsx)(L,{onAddPlace:function(e){var t=e.name,n=e.link;le(!0),j.addNewCard(t,n).then((function(e){te((function(t){return[].concat(Object(i.a)(t),[e.card])})),xe()})).catch((function(e){Ce(!1),console.log(e)})).finally((function(){le(!1)}))},onClose:xe,isOpen:u,isLoading:ie}),Object(O.jsx)(T,{onUpdateAvatar:function(e){le(!0),j.setUserAvatar(e).then((function(e){X(e),xe()})).catch((function(e){Ce(!1),console.log(e)})).finally((function(){le(!1)}))},onClose:xe,isOpen:f,isLoading:ie}),Object(O.jsx)(E,{onDeleteCard:function(e){le(!0),j.deleteCard(e._id).then((function(){te((function(t){return t.filter((function(t){return t._id!==e._id}))})),xe()})).catch((function(e){Ce(!1),console.log(e)})).finally((function(){le(!1)}))},onClose:xe,isOpen:y,selectedCard:se,isLoading:ie}),Object(O.jsx)(w,{isOpen:V,onClose:xe,selectedCard:G})]})})})),q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))};r.a.render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(o.a,{children:Object(O.jsx)(R,{})})}),document.getElementById("root")),q()}},[[39,1,2]]]);
//# sourceMappingURL=main.7e8650bb.chunk.js.map